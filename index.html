<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chronos-X ê´€ë¦¬ íŒ¨ë„</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600;700&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#07100A;--s1:#0C1A10;--s2:#112016;--s3:#162B1C;
  --bd:#1C3524;--bd2:#2A4A34;
  --g:#00FF7F;--g2:#00CC65;--g3:#009948;
  --r:#FF4560;--y:#FFD166;--b:#06D6FF;--o:#FF8C42;
  --t:#B8D4C0;--t2:#5A8068;--t3:#3A5040;--w:#E8F4EC;
  --mono:'IBM Plex Mono',monospace;
  --sans:'Noto Sans KR',sans-serif;
}
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;min-height:100vh;background:var(--bg);color:var(--t);font-family:var(--sans);overflow-x:hidden}

/* ë°°ê²½ ê·¸ë¦¬ë“œ */
body::after{content:'';position:fixed;inset:0;pointer-events:none;z-index:0;
  background-image:linear-gradient(rgba(0,255,127,.02) 1px,transparent 1px),linear-gradient(90deg,rgba(0,255,127,.02) 1px,transparent 1px);
  background-size:40px 40px}

/* â”€â”€ ë¡œê·¸ì¸ â”€â”€ */
#login{position:fixed;inset:0;z-index:100;display:flex;align-items:center;justify-content:center;background:var(--bg)}
.lbox{width:420px;background:var(--s1);border:1px solid var(--bd2);border-radius:4px;padding:48px;position:relative;animation:up .4s ease}
@keyframes up{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
.lbox::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,transparent,var(--g),transparent)}
.eye{font-family:var(--mono);font-size:10px;letter-spacing:4px;color:var(--g2);margin-bottom:8px}
.ltitle{font-size:24px;font-weight:700;color:var(--w);margin-bottom:6px}
.lsub{font-size:13px;color:var(--t2);margin-bottom:28px;line-height:1.6}
.seg{display:flex;background:var(--bg);border:1px solid var(--bd);border-radius:3px;padding:3px;gap:3px;margin-bottom:24px}
.stab{flex:1;padding:9px;background:transparent;border:none;cursor:pointer;font-family:var(--sans);font-size:13px;color:var(--t2);border-radius:2px;transition:all .2s}
.stab.on{background:rgba(0,255,127,.1);color:var(--g);box-shadow:inset 0 0 0 1px rgba(0,255,127,.2)}
.fg{display:flex;flex-direction:column;gap:6px;margin-bottom:16px}
.fl{font-family:var(--mono);font-size:10px;letter-spacing:2px;text-transform:uppercase;color:var(--t2)}
.fi{width:100%;background:rgba(255,255,255,.03);border:1px solid var(--bd);border-radius:3px;padding:11px 13px;color:var(--w);font-family:var(--mono);font-size:13px;outline:none;transition:border-color .2s}
.fi:focus{border-color:var(--g2)}
.fi::placeholder{color:var(--t3)}
.lbtn{width:100%;margin-top:8px;padding:13px;background:var(--g);border:none;color:#040A06;font-family:var(--mono);font-size:12px;font-weight:700;letter-spacing:3px;cursor:pointer;border-radius:3px;transition:all .2s}
.lbtn:hover{background:#33FF99;box-shadow:0 0 20px rgba(0,255,127,.3)}
.lbtn:disabled{opacity:.5;cursor:not-allowed}
.lerr{min-height:20px;margin-top:10px;text-align:center;font-size:12px;font-family:var(--mono);color:var(--r)}

/* â”€â”€ ì•± â”€â”€ */
#app{display:none;min-height:100vh;flex-direction:column;position:relative;z-index:1}
#app.on{display:flex}

/* íƒ‘ë°” */
.top{height:52px;display:flex;align-items:center;justify-content:space-between;padding:0 24px;background:rgba(12,26,16,.95);border-bottom:1px solid var(--bd);position:sticky;top:0;z-index:50;backdrop-filter:blur(10px);flex-shrink:0}
.brand{font-family:var(--mono);font-size:13px;letter-spacing:3px;color:var(--g)}
.brand span{color:var(--t2)}
.pill{display:flex;align-items:center;gap:5px;background:rgba(0,255,127,.06);border:1px solid rgba(0,255,127,.15);padding:3px 10px;border-radius:99px;font-size:11px;color:var(--g2);font-family:var(--mono)}
.dot{width:6px;height:6px;border-radius:50%;background:var(--g);box-shadow:0 0 6px var(--g);animation:bl 2s infinite}
@keyframes bl{0%,100%{opacity:1}50%{opacity:.3}}
.tright{display:flex;align-items:center;gap:10px}
.rchip{padding:4px 10px;border-radius:2px;font-size:10px;font-family:var(--mono);letter-spacing:1px;font-weight:700}
.rchip.super{background:rgba(255,140,66,.12);color:var(--o);border:1px solid rgba(255,140,66,.25)}
.rchip.owner{background:rgba(0,255,127,.08);color:var(--g);border:1px solid rgba(0,255,127,.2)}
.out{padding:5px 12px;border:1px solid var(--bd2);background:transparent;color:var(--t2);font-size:11px;cursor:pointer;border-radius:2px;font-family:var(--mono);transition:all .2s}
.out:hover{border-color:var(--r);color:var(--r)}

/* ë ˆì´ì•„ì›ƒ */
.wrap{display:flex;flex:1;min-height:0}

/* ì‚¬ì´ë“œë°” */
.sb{width:200px;flex-shrink:0;background:var(--s1);border-right:1px solid var(--bd);padding:16px 0}
.sg{margin-bottom:6px}
.sgl{font-family:var(--mono);font-size:9px;letter-spacing:3px;text-transform:uppercase;color:var(--t3);padding:0 14px 6px}
.ni{display:flex;align-items:center;gap:9px;padding:9px 14px;cursor:pointer;font-size:13px;color:var(--t2);border-left:2px solid transparent;transition:all .15s;margin-bottom:1px}
.ni:hover{color:var(--t);background:rgba(0,255,127,.04)}
.ni.on{color:var(--g);background:rgba(0,255,127,.08);border-left-color:var(--g)}
.nico{font-size:13px;width:16px;text-align:center;flex-shrink:0}
.nlk{font-size:9px;margin-left:auto;color:var(--t3)}

/* ë©”ì¸ */
.main{flex:1;padding:28px;overflow-y:auto;min-width:0}
.pg{display:none}
.pg.on{display:block;animation:fin .2s ease}
@keyframes fin{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:translateY(0)}}
.pgh{margin-bottom:24px}
.pgt{font-size:21px;font-weight:700;color:var(--w);margin-bottom:3px}
.pgs{font-size:13px;color:var(--t2)}

/* ì¹´ë“œ */
.card{background:var(--s1);border:1px solid var(--bd);border-radius:3px;padding:22px;margin-bottom:16px;position:relative;overflow:hidden}
.card::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;background:linear-gradient(90deg,var(--g3),transparent 60%);opacity:.5}
.ct{font-family:var(--mono);font-size:11px;letter-spacing:1px;text-transform:uppercase;color:var(--t);margin-bottom:16px;display:flex;align-items:center;gap:8px}

/* ìŠ¤íƒ¯ */
.stats{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:16px}
.stat{background:var(--s2);border:1px solid var(--bd);border-radius:3px;padding:16px 18px}
.sk{font-family:var(--mono);font-size:9px;letter-spacing:2px;text-transform:uppercase;color:var(--t2);margin-bottom:6px}
.sv{font-family:var(--mono);font-size:24px;font-weight:700}
.sv.g{color:var(--g)} .sv.r{color:var(--r)} .sv.b{color:var(--b)} .sv.o{color:var(--o)}

/* í¼ */
.frow{display:flex;gap:10px;align-items:flex-end}
.fg2{flex:1;display:flex;flex-direction:column;gap:5px}
.fl2{font-family:var(--mono);font-size:10px;letter-spacing:1px;text-transform:uppercase;color:var(--t2)}
.fin2,.fsel,.fta{width:100%;background:rgba(255,255,255,.025);border:1px solid var(--bd);border-radius:2px;padding:9px 11px;color:var(--w);font-family:var(--sans);font-size:13px;outline:none;transition:border-color .2s}
.fin2:focus,.fsel:focus,.fta:focus{border-color:var(--g2)}
.fin2::placeholder,.fta::placeholder{color:var(--t3)}
.fsel option{background:var(--s2)}
.fta{resize:vertical;min-height:80px}

/* ë²„íŠ¼ */
.btn{padding:9px 16px;border-radius:2px;font-size:11px;font-family:var(--mono);letter-spacing:1px;cursor:pointer;transition:all .2s;border:none;white-space:nowrap;font-weight:600}
.bg{background:var(--g);color:#040A06}.bg:hover{background:#33FF99;box-shadow:0 0 14px rgba(0,255,127,.3)}
.br{background:rgba(255,69,96,.1);color:var(--r);border:1px solid rgba(255,69,96,.25)}.br:hover{background:rgba(255,69,96,.2)}
.bb{background:rgba(6,214,255,.08);color:var(--b);border:1px solid rgba(6,214,255,.2)}.bb:hover{background:rgba(6,214,255,.15)}
.bo{background:rgba(255,140,66,.08);color:var(--o);border:1px solid rgba(255,140,66,.2)}.bo:hover{background:rgba(255,140,66,.15)}
.bgh{background:transparent;color:var(--t2);border:1px solid var(--bd)}.bgh:hover{border-color:var(--bd2);color:var(--t)}
.btn:disabled{opacity:.4;cursor:not-allowed}

/* í…Œì´ë¸” */
.tw{overflow-x:auto}
table{width:100%;border-collapse:collapse;font-size:13px}
th{text-align:left;padding:8px 12px;font-family:var(--mono);font-size:9px;letter-spacing:2px;text-transform:uppercase;color:var(--t2);border-bottom:1px solid var(--bd)}
td{padding:11px 12px;border-bottom:1px solid rgba(28,53,36,.5);vertical-align:middle}
tr:hover td{background:rgba(0,255,127,.02)}
.tm{font-family:var(--mono);font-size:11px;color:var(--t2)}
.empty td{color:var(--t2);text-align:center;padding:24px;font-size:13px}

/* ë±ƒì§€ */
.badge{display:inline-block;padding:2px 8px;border-radius:2px;font-size:10px;font-family:var(--mono);font-weight:700}
.bsup{background:rgba(255,140,66,.12);color:var(--o)}
.badm{background:rgba(0,255,127,.08);color:var(--g2)}
.bban{background:rgba(255,69,96,.12);color:var(--r)}
.bok{background:rgba(0,255,127,.06);color:var(--t2)}

/* í† ìŠ¤íŠ¸ */
#toast{position:fixed;bottom:24px;right:24px;padding:12px 18px;border-radius:3px;font-size:12px;font-family:var(--mono);background:var(--s2);border:1px solid var(--bd2);z-index:9999;opacity:0;transform:translateY(6px);transition:all .3s;pointer-events:none;max-width:280px;line-height:1.5}
#toast.on{opacity:1;transform:translateY(0)}
#toast.ok{border-color:var(--g2);color:var(--g)}
#toast.er{border-color:var(--r);color:var(--r)}
#toast.wn{border-color:var(--y);color:var(--y)}

/* ëª¨ë‹¬ */
.mo{position:fixed;inset:0;background:rgba(4,8,5,.85);z-index:500;display:none;align-items:center;justify-content:center;backdrop-filter:blur(4px)}
.mo.on{display:flex}
.mbox{background:var(--s1);border:1px solid var(--bd2);border-radius:3px;padding:32px;width:440px;animation:up .3s ease;position:relative}
.mbox::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,var(--r),transparent)}
.mt{font-size:16px;font-weight:700;color:var(--w);margin-bottom:6px}
.ms{font-size:13px;color:var(--t2);margin-bottom:20px;line-height:1.6}
.ma{display:flex;gap:8px;justify-content:flex-end}

/* ì„¹ì…˜í—¤ë” */
.sh{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}

/* info ë°•ìŠ¤ */
.info-box{background:var(--bg);border:1px solid var(--bd);border-radius:2px;padding:10px 13px;font-size:12px;color:var(--t2);margin-bottom:14px;line-height:1.6}

::-webkit-scrollbar{width:4px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:var(--bd);border-radius:2px}
</style>
</head>
<body>

<!-- â•â• ë¡œê·¸ì¸ â•â• -->
<div id="login">
  <div class="lbox">
    <div class="eye">CHRONOS-X CONTROL PANEL</div>
    <div class="ltitle">ê´€ë¦¬ ì‹œìŠ¤í…œ</div>
    <div class="lsub">ì—­í• ì„ ì„ íƒí•˜ê³  ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</div>
    <div class="seg">
      <button class="stab on" id="ts" onclick="setRole('super')">ğŸ‘‘ ì„œë²„ ê´€ë¦¬ì</button>
      <button class="stab" id="to" onclick="setRole('owner')">ğŸ  ë°©ì¥</button>
    </div>
    <div id="sf">
      <div class="fg">
        <div class="fl">ì„œë²„ ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸</div>
        <input class="fi" id="spw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" autocomplete="current-password" />
      </div>
    </div>
    <div id="of" style="display:none">
      <div class="fg">
        <div class="fl">ë°©ì¥ ë¹„ë°€ë²ˆí˜¸</div>
        <input class="fi" id="opw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" autocomplete="current-password" />
      </div>
      <div class="fg">
        <div class="fl">ë‚´ ë°© ID</div>
        <input class="fi" id="rid" placeholder="!ë°©ì½”ë“œ ë¡œ í™•ì¸" />
      </div>
    </div>
    <button class="lbtn" id="lbtn" onclick="doLogin()">[ ì ‘ì† ]</button>
    <div class="lerr" id="lerr"></div>
  </div>
</div>

<!-- â•â• ì•± â•â• -->
<div id="app">
  <div class="top">
    <div style="display:flex;align-items:center;gap:14px">
      <div class="brand">CHRONOS<span>-X</span></div>
      <div class="pill"><span class="dot"></span>BOT ONLINE</div>
    </div>
    <div class="tright">
      <div id="hchip" class="rchip"></div>
      <button class="out" onclick="doLogout()">LOGOUT</button>
    </div>
  </div>
  <div class="wrap">
    <!-- ì‚¬ì´ë“œë°” -->
    <nav class="sb">
      <div class="sg">
        <div class="sgl">OVERVIEW</div>
        <div class="ni on" data-p="home" onclick="go('home',this)"><span class="nico">â—ˆ</span>ëŒ€ì‹œë³´ë“œ</div>
      </div>
      <div class="sg">
        <div class="sgl">ê³µí†µ ê¸°ëŠ¥</div>
        <div class="ni" data-p="ban" onclick="go('ban',this)"><span class="nico">âŠ˜</span>ë°´ / ì–¸ë°´</div>
        <div class="ni" data-p="notice" onclick="go('notice',this)"><span class="nico">â—</span>ê³µì§€ ì „ì†¡</div>
        <div class="ni" data-p="addadmin" onclick="go('addadmin',this)"><span class="nico">â—‰</span>ê´€ë¦¬ì ì„ëª…</div>
        <div class="ni" data-p="restart" onclick="go('restart',this)"><span class="nico">â†º</span>ë´‡ ì¬ì‹œì‘</div>
      </div>
      <div class="sg" id="supernav">
        <div class="sgl">ê´€ë¦¬ì ì „ìš©</div>
        <div class="ni" data-p="admins" onclick="go('admins',this)"><span class="nico">â¬¡</span>ê´€ë¦¬ì ëª©ë¡<span class="nlk">ğŸ”’</span></div>
        <div class="ni" data-p="rooms" onclick="go('rooms',this)"><span class="nico">â–£</span>ë°© ëª©ë¡<span class="nlk">ğŸ”’</span></div>
        <div class="ni" data-p="setpw" onclick="go('setpw',this)"><span class="nico">â—§</span>ë¹„ë°€ë²ˆí˜¸ ì„¤ì •<span class="nlk">ğŸ”’</span></div>
      </div>
    </nav>
    <!-- ë©”ì¸ -->
    <main class="main">

      <!-- í™ˆ -->
      <div class="pg on" id="pg-home">
        <div class="pgh"><div class="pgt">ëŒ€ì‹œë³´ë“œ</div><div class="pgs" id="hdesc">í™˜ì˜í•©ë‹ˆë‹¤.</div></div>
        <div class="stats">
          <div class="stat"><div class="sk">ê´€ë¦¬ ë°© ìˆ˜</div><div class="sv b" id="st-rooms">â€”</div></div>
          <div class="stat"><div class="sk">ë“±ë¡ ê´€ë¦¬ì</div><div class="sv g" id="st-admins">â€”</div></div>
          <div class="stat"><div class="sk">ì°¨ë‹¨ ìœ ì €</div><div class="sv r" id="st-bans">â€”</div></div>
          <div class="stat"><div class="sk">ë´‡ ìƒíƒœ</div><div class="sv g" style="font-size:15px;padding-top:2px">â— ONLINE</div></div>
        </div>
        <div class="card">
          <div class="card::before"></div>
          <div class="ct">âš¡ ë¹ ë¥¸ ì‹¤í–‰</div>
          <div style="display:flex;gap:10px;flex-wrap:wrap">
            <button class="btn bg" onclick="go('ban',null)">ë°´ ê´€ë¦¬</button>
            <button class="btn bgh" onclick="go('notice',null)">ê³µì§€ ì „ì†¡</button>
            <button class="btn bgh" onclick="go('addadmin',null)">ê´€ë¦¬ì ì„ëª…</button>
            <button class="btn bo" onclick="go('restart',null)">ë´‡ ì¬ì‹œì‘</button>
          </div>
        </div>
      </div>

      <!-- ë°´ -->
      <div class="pg" id="pg-ban">
        <div class="pgh"><div class="pgt">ë°´ / ì–¸ë°´</div><div class="pgs">ìœ ì €ë¥¼ ì°¨ë‹¨í•˜ê±°ë‚˜ í•´ì œí•©ë‹ˆë‹¤.</div></div>
        <div class="card">
          <div class="ct">ğŸš« ìœ ì € ì°¨ë‹¨</div>
          <div class="frow" style="margin-bottom:0">
            <div class="fg2"><div class="fl2">ë‹‰ë„¤ì„ ë˜ëŠ” ID</div><input class="fin2" id="ban-tgt" placeholder="ì°¨ë‹¨í•  ìœ ì €" /></div>
            <div class="fg2"><div class="fl2">ì°¨ë‹¨ ì‚¬ìœ </div><input class="fin2" id="ban-rsn" placeholder="ì˜ˆ: ìš•ì„¤, ë„ë°°" /></div>
            <button class="btn br" onclick="doBan()">ì°¨ë‹¨</button>
          </div>
        </div>
        <div class="card">
          <div class="ct">âœ… ì°¨ë‹¨ í•´ì œ</div>
          <div class="frow" style="margin-bottom:0">
            <div class="fg2"><div class="fl2">ë‹‰ë„¤ì„ ë˜ëŠ” ID</div><input class="fin2" id="uban-tgt" placeholder="í•´ì œí•  ìœ ì €" /></div>
            <button class="btn bb" onclick="doUnban()">í•´ì œ</button>
          </div>
        </div>
        <div class="card">
          <div class="sh">
            <div class="ct" style="margin:0">ğŸ“‹ ì°¨ë‹¨ ëª©ë¡</div>
            <button class="btn bgh" onclick="loadBans()">ìƒˆë¡œê³ ì¹¨</button>
          </div>
          <div class="tw">
            <table><thead><tr><th>#</th><th>ë‹‰ë„¤ì„</th><th>ID</th><th>ì‚¬ìœ </th><th>ì²˜ë¦¬ì</th><th>í•´ì œ</th></tr></thead>
            <tbody id="ban-tbody"><tr class="empty"><td colspan="6">ìƒˆë¡œê³ ì¹¨ì„ ëˆŒëŸ¬ ëª©ë¡ ë¡œë“œ</td></tr></tbody></table>
          </div>
        </div>
      </div>

      <!-- ê³µì§€ -->
      <div class="pg" id="pg-notice">
        <div class="pgh"><div class="pgt">ê³µì§€ ì „ì†¡</div><div class="pgs" id="ntc-sub">ë´‡ì´ ìˆëŠ” ë°©ì— ê³µì§€ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.</div></div>
        <div class="card">
          <div class="ct">ğŸ“¢ ê³µì§€ ì‘ì„±</div>
          <div class="fg2" style="margin-bottom:12px">
            <div class="fl2">ì „ì†¡ ë²”ìœ„</div>
            <select class="fsel" id="ntc-scope">
              <option value="all">ì „ì²´ ë°© (ë´‡ì´ ìˆëŠ” ëª¨ë“  ë°©)</option>
              <option value="room">íŠ¹ì • ë°© ID</option>
            </select>
          </div>
          <div class="fg2" id="ntc-rid-grp" style="display:none;margin-bottom:12px">
            <div class="fl2">ë°© ID</div>
            <input class="fin2" id="ntc-rid" placeholder="ë°© ID ì…ë ¥" />
          </div>
          <div class="fg2" style="margin-bottom:14px">
            <div class="fl2">ë©”ì‹œì§€ ë‚´ìš©</div>
            <textarea class="fta" id="ntc-msg" placeholder="ê³µì§€ ë‚´ìš© ì…ë ¥..."></textarea>
          </div>
          <button class="btn bg" onclick="doNotice()">ì „ì†¡</button>
        </div>
      </div>

      <!-- ê´€ë¦¬ì ì„ëª… -->
      <div class="pg" id="pg-addadmin">
        <div class="pgh"><div class="pgt">ê´€ë¦¬ì ì„ëª…</div><div class="pgs">ìœ ì €ì—ê²Œ ì¼ë°˜ ê´€ë¦¬ì ê¶Œí•œì„ ë¶€ì—¬í•©ë‹ˆë‹¤.</div></div>
        <div class="card">
          <div class="ct">â• ì„ëª…í•˜ê¸°</div>
          <div class="info-box">âš  ì„ëª…ëœ ê´€ë¦¬ìëŠ” ë°´/ì–¸ë°´, ê³µì§€, ê´€ë¦¬ì ì„ëª… ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>ê´€ë¦¬ì í•´ì œëŠ” ì„œë²„ ê´€ë¦¬ì ì „ìš© ë©”ë‰´ì—ì„œ ê°€ëŠ¥í•©ë‹ˆë‹¤.</div>
          <div class="frow" style="margin-bottom:0">
            <div class="fg2"><div class="fl2">ë‹‰ë„¤ì„ ë˜ëŠ” ID</div><input class="fin2" id="adm-tgt" placeholder="ì„ëª…í•  ìœ ì €" /></div>
            <button class="btn bg" onclick="doAddAdmin()">ì„ëª…</button>
          </div>
        </div>
      </div>

      <!-- ë´‡ ì¬ì‹œì‘ -->
      <div class="pg" id="pg-restart">
        <div class="pgh"><div class="pgt">ë´‡ ì¬ì‹œì‘</div><div class="pgs">ë´‡ ì„œë²„ë¥¼ ì¦‰ì‹œ ì¬ì‹œì‘í•©ë‹ˆë‹¤.</div></div>
        <div class="card" style="border-color:rgba(255,209,102,.2)">
          <div class="ct">â†º ì¬ì‹œì‘</div>
          <p style="font-size:13px;color:var(--t2);margin-bottom:18px;line-height:1.7">ë´‡ ì¬ì‹œì‘ í›„ ì•½ 5~10ì´ˆê°„ ì‘ë‹µì´ ì—†ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>ìë™ìœ¼ë¡œ ì¬ì—°ê²°ë©ë‹ˆë‹¤.</p>
          <button class="btn bo" onclick="openModal('restart','ë´‡ ì¬ì‹œì‘','ì§€ê¸ˆ ë´‡ ì„œë²„ë¥¼ ì¬ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">â†º ì§€ê¸ˆ ì¬ì‹œì‘</button>
        </div>
      </div>

      <!-- ê´€ë¦¬ì ëª©ë¡ -->
      <div class="pg" id="pg-admins">
        <div class="pgh"><div class="pgt">ê´€ë¦¬ì ëª©ë¡</div><div class="pgs">ì„œë²„ ê´€ë¦¬ì ì „ìš© â€” ê´€ë¦¬ì í•´ì œ í¬í•¨.</div></div>
        <div class="card">
          <div class="sh">
            <div class="ct" style="margin:0">ğŸ“‹ ì „ì²´ ëª©ë¡</div>
            <div style="display:flex;gap:8px">
              <button class="btn bgh" onclick="loadAdmins()">ìƒˆë¡œê³ ì¹¨</button>
              <button class="btn br" onclick="openModal('clearadmins','ì¼ë°˜ ê´€ë¦¬ì ì „ì²´ í•´ì œ','ëª¨ë“  ì¼ë°˜ ê´€ë¦¬ì ê¶Œí•œì„ í•´ì œí•©ë‹ˆë‹¤. ë³µêµ¬ ë¶ˆê°€.')">ì „ì²´ í•´ì œ</button>
            </div>
          </div>
          <div class="tw">
            <table><thead><tr><th>#</th><th>ë‹‰ë„¤ì„</th><th>ê¶Œí•œ</th><th>ë“±ë¡ ë°©</th><th>ì•¡ì…˜</th></tr></thead>
            <tbody id="adm-tbody"><tr class="empty"><td colspan="5">ìƒˆë¡œê³ ì¹¨ì„ ëˆ„ë¥´ì„¸ìš”</td></tr></tbody></table>
          </div>
        </div>
      </div>

      <!-- ë°© ëª©ë¡ -->
      <div class="pg" id="pg-rooms">
        <div class="pgh"><div class="pgt">ë°© ëª©ë¡</div><div class="pgs">ë´‡ì´ ë°°ì¹˜ëœ ëª¨ë“  ë°© ëª©ë¡ì…ë‹ˆë‹¤.</div></div>
        <div class="card">
          <div class="sh">
            <div class="ct" style="margin:0">ğŸ  ë°© ëª©ë¡</div>
            <button class="btn bgh" onclick="loadRooms()">ìƒˆë¡œê³ ì¹¨</button>
          </div>
          <div class="tw">
            <table><thead><tr><th>#</th><th>ë°© ID</th><th>ê³µì§€</th></tr></thead>
            <tbody id="room-tbody"><tr class="empty"><td colspan="3">ìƒˆë¡œê³ ì¹¨ì„ ëˆ„ë¥´ì„¸ìš”</td></tr></tbody></table>
          </div>
        </div>
      </div>

      <!-- ë¹„ë°€ë²ˆí˜¸ ì„¤ì • -->
      <div class="pg" id="pg-setpw">
        <div class="pgh"><div class="pgt">ë¹„ë°€ë²ˆí˜¸ ì„¤ì •</div><div class="pgs">ëŒ€ì‹œë³´ë“œ ë¡œê·¸ì¸ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•©ë‹ˆë‹¤. ì„œë²„ ê´€ë¦¬ì ì „ìš©.</div></div>
        <div class="card">
          <div class="ct">ğŸ” ì„œë²„ ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸</div>
          <div class="fg2" style="margin-bottom:10px"><div class="fl2">ìƒˆ ë¹„ë°€ë²ˆí˜¸</div><input class="fin2" id="spw1" type="password" placeholder="6ì ì´ìƒ" /></div>
          <div class="fg2" style="margin-bottom:14px"><div class="fl2">í™•ì¸</div><input class="fin2" id="spw2" type="password" placeholder="ë‹¤ì‹œ ì…ë ¥" /></div>
          <button class="btn bg" onclick="doSetPw('super')">ë³€ê²½</button>
        </div>
        <div class="card">
          <div class="ct">ğŸ”‘ ë°©ì¥ ë¹„ë°€ë²ˆí˜¸</div>
          <div class="fg2" style="margin-bottom:10px"><div class="fl2">ìƒˆ ë¹„ë°€ë²ˆí˜¸</div><input class="fin2" id="opw1" type="password" placeholder="6ì ì´ìƒ" /></div>
          <div class="fg2" style="margin-bottom:14px"><div class="fl2">í™•ì¸</div><input class="fin2" id="opw2" type="password" placeholder="ë‹¤ì‹œ ì…ë ¥" /></div>
          <button class="btn bb" onclick="doSetPw('owner')">ë³€ê²½</button>
        </div>
      </div>

    </main>
  </div>
</div>

<!-- ëª¨ë‹¬ -->
<div class="mo" id="modal">
  <div class="mbox">
    <div class="mt" id="m-title">í™•ì¸</div>
    <div class="ms" id="m-sub">ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</div>
    <div class="ma">
      <button class="btn bgh" onclick="closeModal()">ì·¨ì†Œ</button>
      <button class="btn br" id="m-ok" onclick="doModal()">ì‹¤í–‰</button>
    </div>
  </div>
</div>

<div id="toast"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ì „ì—­ ìƒíƒœ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const S = {
  role: 'super',
  pw: '',          // ë¡œê·¸ì¸ ì‹œ ì…ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ (API ìš”ì²­ë§ˆë‹¤ ìë™ ì²¨ë¶€)
  roomId: '',
  apiUrl: '',      // ë´‡ ì„œë²„ http://IP:9090
  modalAction: null
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ìœ í‹¸
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let _tid;
function toast(msg, type='ok'){
  const el=document.getElementById('toast');
  el.textContent=msg; el.className='on '+type;
  clearTimeout(_tid); _tid=setTimeout(()=>el.className='',3000);
}

function maskId(id){
  const s=String(id||'');
  return s.length<=4?'****':s.slice(0,4)+'****';
}

function setErr(msg){
  const el=document.getElementById('lerr');
  el.textContent=msg;
  setTimeout(()=>el.textContent='',4000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  API í˜¸ì¶œ â€” í•µì‹¬
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function call(path, body=null, skipAuth=false){
  // skipAuth=true ì´ë©´ ì¸ì¦ ì •ë³´ ì—†ì´ ì „ì†¡ (ë¡œê·¸ì¸ ì „ìš©)
  const payload = skipAuth
    ? (body || {})
    : {
        role:     S.role,
        password: S.pw,
        ...(S.roomId ? { roomId: S.roomId } : {}),
        ...(body || {})
      };

  try {
    const res = await fetch(S.apiUrl + path, {
      method:  'POST',
      headers: { 'Content-Type': 'application/json' },
      body:    JSON.stringify(payload)
    });

    let json;
    const text = await res.text();
    try { json = JSON.parse(text); }
    catch { json = { success: res.ok }; }

    return { ok: res.ok, status: res.status, data: json };

  } catch(e) {
    return { ok: false, status: 0, data: { success: false, error: 'ì„œë²„ ì—°ê²° ì‹¤íŒ¨: '+e.message } };
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ë¡œê·¸ì¸
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setRole(r){
  S.role=r;
  document.getElementById('ts').classList.toggle('on', r==='super');
  document.getElementById('to').classList.toggle('on', r==='owner');
  document.getElementById('sf').style.display = r==='super'?'block':'none';
  document.getElementById('of').style.display = r==='owner'?'block':'none';
}

async function doLogin(){
  // API URL = ì´ HTML ì„ ì„œë¹™í•˜ëŠ” ì„œë²„ì˜ í˜¸ìŠ¤íŠ¸ + í¬íŠ¸ 9090
  S.apiUrl = location.protocol+'//'+location.hostname+':9090';

  const btn = document.getElementById('lbtn');
  btn.disabled=true; btn.textContent='ì ‘ì† ì¤‘...';

  try {
    if(S.role === 'super'){
      const pw = document.getElementById('spw').value.trim();
      if(!pw){ setErr('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.'); return; }

      S.pw = pw;
      const { ok, status, data } = await call('/api/login', { role:'super', password:pw }, true);

      if(ok && data.success){
        enterApp('super');
      } else {
        S.pw='';
        setErr(data.error || (status===401?'ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.':'ì„œë²„ ì˜¤ë¥˜: '+status));
      }

    } else {
      const pw  = document.getElementById('opw').value.trim();
      const rid = document.getElementById('rid').value.trim();
      if(!pw){ setErr('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.'); return; }
      if(!rid){ setErr('ë°© IDë¥¼ ì…ë ¥í•˜ì„¸ìš”.'); return; }

      S.pw=pw; S.roomId=rid;
      const { ok, status, data } = await call('/api/login', { role:'owner', password:pw, roomId:rid }, true);

      if(ok && data.success){
        enterApp('owner');
      } else {
        S.pw=''; S.roomId='';
        setErr(data.error || (status===401?'ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.':'ì„œë²„ ì˜¤ë¥˜: '+status));
      }
    }
  } finally {
    btn.disabled=false; btn.textContent='[ ì ‘ì† ]';
  }
}

function enterApp(role){
  document.getElementById('login').style.display='none';
  document.getElementById('app').classList.add('on');

  const chip = document.getElementById('hchip');
  chip.textContent = role==='super'?'ğŸ‘‘ ì„œë²„ ê´€ë¦¬ì':'ğŸ  ë°©ì¥';
  chip.className='rchip '+(role==='super'?'super':'owner');

  document.getElementById('hdesc').textContent =
    role==='super'
      ?'ì„œë²„ ê´€ë¦¬ìë¡œ ì ‘ì†í–ˆìŠµë‹ˆë‹¤. ëª¨ë“  ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
      :`ë°©ì¥ìœ¼ë¡œ ì ‘ì†í–ˆìŠµë‹ˆë‹¤. ë°© ID: ${S.roomId}`;

  if(role==='owner'){
    document.getElementById('supernav').style.display='none';
    // ê³µì§€: ì „ì²´ë°© ì˜µì…˜ ì œê±°
    const sel=document.getElementById('ntc-scope');
    sel.innerHTML=`<option value="room">ë‚´ ë°© (${S.roomId})</option>`;
    sel.disabled=true;
    document.getElementById('ntc-rid').value=S.roomId;
    document.getElementById('ntc-sub').textContent='ìì‹ ì˜ ë°©ì— ê³µì§€ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.';
  }

  loadStats();
}

function doLogout(){
  document.getElementById('login').style.display='flex';
  document.getElementById('app').classList.remove('on');
  document.getElementById('supernav').style.display='block';
  S.role='super'; S.pw=''; S.roomId=''; S.apiUrl=''; S.modalAction=null;
  // ê³µì§€ ì˜µì…˜ ë³µì›
  const sel=document.getElementById('ntc-scope');
  sel.innerHTML='<option value="all">ì „ì²´ ë°©</option><option value="room">íŠ¹ì • ë°© ID</option>';
  sel.disabled=false;
  setRole('super');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ë‚´ë¹„ê²Œì´ì…˜
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function go(name, el){
  document.querySelectorAll('.pg').forEach(p=>p.classList.remove('on'));
  document.querySelectorAll('.ni').forEach(n=>n.classList.remove('on'));
  document.getElementById('pg-'+name).classList.add('on');
  if(el) el.classList.add('on');
  else document.querySelectorAll('.ni').forEach(n=>{if(n.dataset.p===name)n.classList.add('on');});
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  í†µê³„
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function loadStats(){
  const { ok, data } = await call('/api/stats');
  if(ok){
    document.getElementById('st-rooms').textContent  = data.rooms  ?? '?';
    document.getElementById('st-admins').textContent = data.admins ?? '?';
    document.getElementById('st-bans').textContent   = data.bans   ?? '?';
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ë°´ ê´€ë¦¬
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function doBan(){
  const tgt = document.getElementById('ban-tgt').value.trim();
  const rsn = document.getElementById('ban-rsn').value.trim() || 'ì‚¬ìœ  ì—†ìŒ';
  if(!tgt){ toast('ì°¨ë‹¨í•  ìœ ì €ë¥¼ ì…ë ¥í•˜ì„¸ìš”.','er'); return; }

  const { ok, data } = await call('/api/ban', { target:tgt, reason:rsn });
  if(ok && data.success){
    toast(`âœ… ${tgt} ì°¨ë‹¨ ì™„ë£Œ`);
    document.getElementById('ban-tgt').value='';
    document.getElementById('ban-rsn').value='';
    loadBans();
  } else {
    toast(data.error||'ì°¨ë‹¨ ì‹¤íŒ¨','er');
  }
}

async function doUnban(){
  const tgt = document.getElementById('uban-tgt').value.trim();
  if(!tgt){ toast('í•´ì œí•  ìœ ì €ë¥¼ ì…ë ¥í•˜ì„¸ìš”.','er'); return; }

  const { ok, data } = await call('/api/unban', { target:tgt });
  if(ok && data.success){
    toast(`âœ… ${tgt} ì°¨ë‹¨ í•´ì œ`);
    document.getElementById('uban-tgt').value='';
    loadBans();
  } else {
    toast(data.error||'í•´ì œ ì‹¤íŒ¨','er');
  }
}

async function loadBans(){
  const { ok, data } = await call('/api/banlist');
  const tb = document.getElementById('ban-tbody');
  if(ok && data.list){
    if(!data.list.length){
      tb.innerHTML='<tr class="empty"><td colspan="6">ì°¨ë‹¨ëœ ìœ ì €ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
    } else {
      tb.innerHTML = data.list.map((u,i)=>`
        <tr>
          <td>${i+1}</td>
          <td>${u.name||'ì•Œìˆ˜ì—†ìŒ'}</td>
          <td class="tm">${maskId(u.id)}</td>
          <td>${u.reason||'â€”'}</td>
          <td style="font-size:12px;color:var(--t2)">${u.admin||'â€”'}</td>
          <td><button class="btn bgh" style="padding:4px 10px;font-size:10px" onclick="quickUnban('${u.id}','${u.name||u.id}')">í•´ì œ</button></td>
        </tr>`).join('');
    }
  } else {
    tb.innerHTML=`<tr class="empty"><td colspan="6">${data.error||'ë¡œë“œ ì‹¤íŒ¨'}</td></tr>`;
  }
}

async function quickUnban(id, name){
  const { ok, data } = await call('/api/unban', { target:id });
  toast(ok&&data.success?`âœ… ${name} í•´ì œ`:(data.error||'í•´ì œ ì‹¤íŒ¨'), ok&&data.success?'ok':'er');
  loadBans();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ê³µì§€
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.getElementById('ntc-scope').addEventListener('change', function(){
  document.getElementById('ntc-rid-grp').style.display = this.value==='room'?'flex':'none';
});

async function doNotice(){
  const msg   = document.getElementById('ntc-msg').value.trim();
  const scope = document.getElementById('ntc-scope').value;
  const rid   = document.getElementById('ntc-rid').value.trim();
  if(!msg){ toast('ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.','er'); return; }
  if(scope==='room'&&!rid){ toast('ë°© IDë¥¼ ì…ë ¥í•˜ì„¸ìš”.','er'); return; }

  const { ok, data } = await call('/api/notice', { content:msg, scope, roomId:rid||undefined });
  if(ok && data.success){
    toast(`âœ… ê³µì§€ ì „ì†¡ ì™„ë£Œ (${data.sent||0}ê°œ ë°©)`);
    document.getElementById('ntc-msg').value='';
  } else {
    toast(data.error||'ì „ì†¡ ì‹¤íŒ¨','er');
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ê´€ë¦¬ì ì„ëª…
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function doAddAdmin(){
  const tgt = document.getElementById('adm-tgt').value.trim();
  if(!tgt){ toast('ì„ëª…í•  ìœ ì €ë¥¼ ì…ë ¥í•˜ì„¸ìš”.','er'); return; }

  const { ok, data } = await call('/api/addadmin', { target:tgt });
  if(ok && data.success){
    toast(`âœ… ${tgt} ê´€ë¦¬ì ì„ëª… ì™„ë£Œ`);
    document.getElementById('adm-tgt').value='';
  } else {
    toast(data.error||'ì„ëª… ì‹¤íŒ¨','er');
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ê´€ë¦¬ì ëª©ë¡ (ê´€ë¦¬ì ì „ìš©)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function loadAdmins(){
  const { ok, data } = await call('/api/adminlist');
  const tb = document.getElementById('adm-tbody');
  if(ok && data.list){
    if(!data.list.length){
      tb.innerHTML='<tr class="empty"><td colspan="5">ë“±ë¡ëœ ê´€ë¦¬ìê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
    } else {
      tb.innerHTML = data.list.map((a,i)=>`
        <tr>
          <td>${i+1}</td>
          <td>${a.name||'â€”'}</td>
          <td><span class="badge ${a.role==='super'?'bsup':'badm'}">${a.role==='super'?'ì„œë²„ê´€ë¦¬ì':'ì¼ë°˜ê´€ë¦¬ì'}</span></td>
          <td class="tm">${a.room||'â€”'}</td>
          <td>${a.role!=='super'
            ?`<button class="btn br" style="padding:4px 10px;font-size:10px" onclick="removeAdmin('${a.id}','${a.name||a.id}')">í•´ì œ</button>`
            :'<span style="font-size:11px;color:var(--t2)">ë³´í˜¸ë¨</span>'
          }</td>
        </tr>`).join('');
    }
  } else {
    tb.innerHTML=`<tr class="empty"><td colspan="5">${data.error||'ë¡œë“œ ì‹¤íŒ¨'}</td></tr>`;
  }
}

async function removeAdmin(id, name){
  const { ok, data } = await call('/api/removeadmin', { target:id });
  toast(ok&&data.success?`âœ… ${name} ê´€ë¦¬ì í•´ì œ`:(data.error||'í•´ì œ ì‹¤íŒ¨'), ok&&data.success?'ok':'er');
  loadAdmins();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ë°© ëª©ë¡ (ê´€ë¦¬ì ì „ìš©)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function loadRooms(){
  const { ok, data } = await call('/api/rooms');
  const tb = document.getElementById('room-tbody');
  if(ok && data.rooms){
    if(!data.rooms.length){
      tb.innerHTML='<tr class="empty"><td colspan="3">ë°©ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
    } else {
      tb.innerHTML = data.rooms.map((r,i)=>`
        <tr>
          <td>${i+1}</td>
          <td class="tm">${r}</td>
          <td><button class="btn bgh" style="padding:4px 10px;font-size:10px" onclick="quickNotice('${r}')">ê³µì§€</button></td>
        </tr>`).join('');
    }
  } else {
    tb.innerHTML=`<tr class="empty"><td colspan="3">${data.error||'ë¡œë“œ ì‹¤íŒ¨'}</td></tr>`;
  }
}

function quickNotice(rid){
  go('notice', null);
  document.getElementById('ntc-scope').value='room';
  document.getElementById('ntc-rid-grp').style.display='flex';
  document.getElementById('ntc-rid').value=rid;
  toast('ë°© ID ì„¤ì •ë¨. ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ (ê´€ë¦¬ì ì „ìš©)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function doSetPw(who){
  const p1 = document.getElementById(who==='super'?'spw1':'opw1').value.trim();
  const p2 = document.getElementById(who==='super'?'spw2':'opw2').value.trim();
  if(!p1){ toast('ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.','er'); return; }
  if(p1!==p2){ toast('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.','er'); return; }
  if(p1.length<6){ toast('6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.','er'); return; }

  const { ok, data } = await call('/api/setpw', { target:who, newpw:p1 });
  if(ok && data.success){
    toast(`âœ… ${who==='super'?'ê´€ë¦¬ì':'ë°©ì¥'} ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì™„ë£Œ`);
    // í˜„ì¬ ì„¸ì…˜ ë¹„ë°€ë²ˆí˜¸ë„ ì—…ë°ì´íŠ¸
    if(S.role===who) S.pw=p1;
    document.getElementById(who==='super'?'spw1':'opw1').value='';
    document.getElementById(who==='super'?'spw2':'opw2').value='';
  } else {
    toast(data.error||'ë³€ê²½ ì‹¤íŒ¨','er');
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ëª¨ë‹¬ (ìœ„í—˜ ì‘ì—… í™•ì¸)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openModal(action, title, sub){
  S.modalAction=action;
  document.getElementById('m-title').textContent=title;
  document.getElementById('m-sub').textContent=sub;
  document.getElementById('modal').classList.add('on');
}
function closeModal(){ document.getElementById('modal').classList.remove('on'); S.modalAction=null; }

async function doModal(){
  const action = S.modalAction;
  closeModal();
  if(!action) return;

  if(action==='restart'){
    const { ok, data } = await call('/api/restart');
    toast(ok&&data.success?'âœ… ì¬ì‹œì‘ ëª…ë ¹ ì „ì†¡ë¨':(data.error||'ì‹¤íŒ¨'),'ok');

  } else if(action==='clearadmins'){
    const { ok, data } = await call('/api/clearadmins');
    toast(ok&&data.success?'âœ… ì¼ë°˜ ê´€ë¦¬ì ì „ì²´ í•´ì œ':(data.error||'ì‹¤íŒ¨'), ok&&data.success?'ok':'er');
    loadAdmins();
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  í‚¤ë³´ë“œ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('keydown', e=>{
  if(e.key==='Enter' && document.getElementById('login').style.display!=='none'){
    doLogin();
  }
  if(e.key==='Escape') closeModal();
});

// í˜ì´ì§€ ë¡œë“œ ì‹œ API URL ë¯¸ë¦¬ í‘œì‹œ (ë””ë²„ê·¸ìš©)
window.addEventListener('load', ()=>{
  console.log('[Chronos-X] ëŒ€ì‹œë³´ë“œ ë¡œë“œë¨. ì—°ê²° ì„œë²„:', location.protocol+'//'+location.hostname+':9090');
});
</script>
</body>
</html>
